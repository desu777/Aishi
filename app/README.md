# Aishi Frontend Application

## Overview

Frontend application for the Aishi iNFT system, built with Next.js 15, React 19, and TypeScript. Features terminal-style agent interaction, personality evolution, memory consolidation, and decentralized storage integration with the 0G Network.

## Contract Integration Architecture

### Smart Contract Configuration System

The application uses a centralized, type-safe contract configuration system:

#### Type-Safe ABI Generation
```bash
# Generate TypeScript types from contract ABI
npm run generate-abi
```

This command uses Wagmi CLI to process `src/abi/AishiAgentABI.json` and generate `src/generated.ts` with:
- **Typed ABI interfaces** for full TypeScript safety
- **Contract addresses** for different networks
- **Hook generators** for React integration

#### Centralized Configuration
```typescript
// src/hooks/agentHooks/config/contractConfig.ts
import { aishiAgentAbi } from '../../../generated';

export const getContractConfig = (): ContractConfig => ({
  address: process.env.NEXT_PUBLIC_AISHI_AGENT_ADDRESS || '0x5Bc063f0...',
  abi: aishiAgentAbi,  // Type-safe ABI from generated.ts
  chainId: 16601,
  contractName: 'AishiAgent',
  network: 'galileo'
});
```

#### Hook Integration Pattern
All contract interactions use the centralized configuration:

```typescript
// Example hook pattern
const useContractOperation = () => {
  const contractConfig = getContractConfig();
  
  const performOperation = async () => {
    const contract = new Contract(
      contractConfig.address,
      contractConfig.abi,
      signer
    );
    
    // Type-safe contract method calls
    await contract.methodName(params);
  };
};
```

### Contract Integration Benefits

- **Type Safety**: Full TypeScript IntelliSense for contract methods
- **Single Source of Truth**: One configuration file for all contract interactions
- **Environment Flexibility**: Contract addresses via environment variables
- **Automatic Updates**: ABI changes automatically propagate through type system
- **Error Prevention**: Compile-time validation of contract calls

## Application Structure

```
app/
├── src/
│   ├── agent_dashboard/        # Terminal interface & command system
│   ├── hooks/
│   │   └── agentHooks/         # Agent-specific hooks using centralized config
│   │       ├── config/         # Contract configuration
│   │       │   └── contractConfig.ts  # Centralized contract config
│   │       ├── services/       # Business logic services
│   │       ├── types/          # TypeScript interfaces
│   │       └── [various hooks] # All using getContractConfig()
│   ├── generated.ts            # Auto-generated by Wagmi CLI
│   ├── abi/                   # ABI files (source for generation)
│   └── [other directories]
├── wagmi.config.ts            # Wagmi CLI configuration
└── package.json               # Includes "generate-abi" script
```

## Contract-Connected Components

### Agent Dashboard Terminal

Terminal-style interface with commands that interact with smart contracts:

- **mint**: Creates new agent NFTs using contract minting functions
- **info**: Reads agent data from blockchain via contract queries  
- **stats**: Displays on-chain statistics and metrics
- **dream**: Records dreams to blockchain after AI processing
- **chat**: Saves conversations to contract after analysis
- **month-learn**: Performs monthly consolidation with contract updates

### Agent Hooks (Contract Integration Layer)

All hooks use the centralized contract configuration:

#### Core Agent Operations
- **useAgentRead**: Contract data fetching with type safety
- **useAgentMint**: NFT creation with typed contract calls  
- **useAgentDream**: Dream processing with blockchain storage
- **useAgentChat**: Conversation management and contract recording

#### Memory System Hooks
- **useMonthLearn**: Monthly consolidation with contract updates
- **useAgentMemoryCore**: Long-term memory contract operations
- **useAgentConsolidation**: Legacy consolidation system

#### Configuration Flow
1. **Wagmi CLI** generates types from ABI files
2. **contractConfig.ts** imports generated types
3. **All hooks** use getContractConfig() for consistency
4. **Type safety** enforced at compile time

## Development Workflow

### Contract Changes Integration

When smart contracts are updated:

1. **Deploy Contract** (in contracts/ directory)
   ```bash
   npm run deploy:wsl
   ```
   - Automatically exports new ABI to `app/src/abi/AishiAgentABI.json`

2. **Generate Types** (in app/ directory)
   ```bash
   npm run generate-abi
   ```
   - Creates `src/generated.ts` with updated types

3. **Update Configuration** (if needed)
   ```typescript
   // Update environment variable for new address
   NEXT_PUBLIC_AISHI_AGENT_ADDRESS=0xNEW_ADDRESS
   ```

4. **Automatic Propagation**
   - All hooks automatically use new contract configuration
   - TypeScript compilation validates all contract calls
   - Runtime errors prevented through type safety

### Environment Configuration

```env
# Contract Configuration
NEXT_PUBLIC_AISHI_AGENT_ADDRESS=0x5Bc063f0eeFa5D90831FD2b4AF33D1529c993bFe

# Network Configuration  
NEXT_PUBLIC_CHAIN_ID=16601
NEXT_PUBLIC_L1_RPC=https://evmrpc-testnet.0g.ai

# Storage Configuration
NEXT_PUBLIC_TURBO_STORAGE_RPC=https://indexer-storage-testnet-turbo.0g.ai

# Compute Configuration
NEXT_PUBLIC_COMPUTE_API_URL=http://localhost:3001/api

# Debug Configuration
NEXT_PUBLIC_DREAM_TEST=true
NEXT_PUBLIC_CONSOLIDATION_TEST=true
```

## Key Features

### Type-Safe Contract Integration
- Full TypeScript IntelliSense for contract methods
- Compile-time validation of contract calls
- Automatic type generation from ABI

### Centralized Configuration
- Single configuration source for all contract interactions
- Environment-based address management
- Consistent error handling across hooks

### Memory System Architecture
- Daily dream and conversation storage
- Monthly consolidation workflows
- Yearly memory core generation
- Hybrid storage: hashes on-chain, content on 0G Network

### AI Integration
- 0G Compute Network for AI processing
- Structured prompt/response systems
- Personality evolution through interactions

## Available Scripts

```bash
# Development
npm run dev              # Start development server (port 3003)
npm run build           # Production build
npm run start           # Start production server

# Type Generation
npm run generate-abi    # Generate TypeScript types from ABI
```

## Architecture Principles

- **Type Safety**: Full TypeScript coverage with generated contract types
- **Centralized Configuration**: Single source of truth for contract settings
- **Component Composition**: Modular design with focused responsibilities
- **Hook-Based Logic**: Business logic separated into custom hooks
- **Error Prevention**: Compile-time validation prevents runtime contract errors
- **Environment Flexibility**: Easy deployment across different networks

## Network Configuration

### Galileo Testnet
- **Chain ID**: 16601
- **RPC**: https://evmrpc-testnet.0g.ai
- **Explorer**: https://explorer-testnet.0g.ai
- **Faucet**: https://faucet.0g.ai

### Contract Addresses
Contract addresses are managed through environment variables and automatically loaded into the centralized configuration system.

## Technologies

- **Framework**: Next.js 15 with App Router
- **Language**: TypeScript with strict type checking
- **Web3**: Wagmi v2 + Viem for type-safe contract interactions
- **UI**: React 19 + Tailwind CSS
- **Blockchain**: 0G Network Galileo Testnet
- **Storage**: 0G Network decentralized storage
- **AI**: 0G Compute Network integration

## Related Documentation

- Smart contracts: `../contracts/README.md`
- Project overview: `../CLAUDE.md`
- Backend services: `../0g-compute/README.md`